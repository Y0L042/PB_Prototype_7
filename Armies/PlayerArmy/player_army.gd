extends Army

#---------------------------------------------------------------------------------------------------#
# Private Variables
#---------------------------------------------------------------------------------------------------#



#---------------------------------------------------------------------------------------------------#
# Public Variables
#---------------------------------------------------------------------------------------------------#

#---------------------------------------------------------------------------------------------------#
# SetGet
#---------------------------------------------------------------------------------------------------#


#---------------------------------------------------------------------------------------------------#
# Private Functions
#---------------------------------------------------------------------------------------------------#
#-------------------------------------------------------------------------------
# Initialization
#-------------------------------------------------------------------------------


#-------------------------------------------------------------------------------
# Runtime
#-------------------------------------------------------------------------------
func _custom_process(delta: float):
	_move_army()

	_draw_debug()



#-------------------------------------------------------------------------------
# Movement Functions
#-------------------------------------------------------------------------------
func _move_army():
	var _input_vec: Vector2 = Input.get_vector("game_action_left", "game_action_right", "game_action_up", "game_action_down", 0.5)
	_army_velocity = _input_vec * army_speed
	_move()
#-------------------------------------------------------------------------------
# Tools
#-------------------------------------------------------------------------------


#---------------------------------------------------------------------------------------------------#
# Public Functions
#---------------------------------------------------------------------------------------------------#

#---------------------------------------------------------------------------------------------------#
# %debug%
#---------------------------------------------------------------------------------------------------#
func _draw_debug():
	queue_redraw()

func _draw() -> void: #%Debug
	_debug_draw_army_formation()
	_debug_draw_army_position(get_army_position())
	_debug_draw_army_velocity(get_army_position(), _army_velocity)

func _debug_draw_army_formation():
	var col = Color(0.75, 0, 0)
	var rad = int(GlobalSettings.UNIT/2)
	for spot in _formation.vector_array:
		draw_circle(spot, rad, col)

func _debug_draw_army_position(new_pos):
	var col = Color(1, 0, 0)
	var rad = int(GlobalSettings.UNIT/2)
	draw_circle(new_pos, rad, col)

func _debug_draw_army_velocity(start, end):
	var col = Color(0, 0, 1)
	var width = 0.1
	end += start
	draw_line(start, end, col, width)
